# 齐家AI 数据看板

实时数据展示与分析平台，帮助团队监控产品质量和用户反馈。

## 总体定位

- **目标**：真实反映产品质量，帮助改进优化产品
- **受众**：核心团队、志愿者、公众
- **原则**：数据面板公开透明
- **数据更新**：每日更新（基于自然日 0:00-24:00）

## 线上地址

- **数据看板**：https://database-production-ba39.up.railway.app/
- **代码仓库**：https://github.com/zhaoyidemo/database

---

## 功能模块

### 一、基础数据
- **核心指标**：发起对话人数、生成洞察人数、对话轮数、评分人数（昨日 + 历史累计）
- **转化率指标**：洞察触发率、评分率（显示计算公式和具体数值）
- **趋势图**：支持 7天/30天/自定义日期

### 二、用户评分
- **评分分布**：5分、4分、低分（1-3分）、未评分人数及占比
- **趋势图**：支持人数/占比切换，堆叠柱状图展示

### 三、点踩数据
- **核心指标**：点踩轮次数、点踩人数（去重）、点踩率
- **趋势图**：支持轮次数/人数/点踩率切换

### 四、AB版本对比
- **A版**：心理咨询风格
- **B版**：教练技术风格
- **分组规则**：用户按ID单双号固定分配
- **对比维度**：基础数据、用户评分、点踩数据
- **时间筛选**：支持 7天/30天/自定义日期

---

## 通用规则

| 规则 | 说明 |
|------|------|
| 页面头部 | 显示标题、数据说明、最后更新时间和刷新按钮 |
| 时间选择器 | 过去7天（默认）、过去30天、自定义日期 |
| 数据定义提示 | 指标字段旁显示 **!** 图标，悬停显示定义 |
| 空状态 | 无数据时显示 **0**（而非「-」或「暂无数据」） |

---

## 业务规则

| 规则 | 说明 |
|------|------|
| 对话轮数 | 一问一答 = 1轮 |
| 历史累计起始时间 | 数据面板部署上线时间 |
| 点踩对象 | 针对单条 AI 回复 |
| 评分规则 | 同一用户对同一洞察只能评分一次 |
| 人数统计 | 所有"人数"类指标均为去重后的用户数 |

---

## 数据定义汇总

| 术语 | 定义 |
|------|------|
| 昨日 | 自然日（0:00-24:00） |
| 发起对话人数 | 至少发起1次对话的用户数（去重） |
| 生成洞察人数 | 至少主动点击生成1次洞察的用户数（去重） |
| 评分人数 | 至少完成1次评分的用户数（去重） |
| 对话轮数 | 一问一答 = 1轮 |
| 点踩轮次数 | 被用户点踩的AI回复数量 |
| 点踩人数（去重） | 至少点踩1次的用户数（去重） |
| 洞察触发率 | 生成洞察用户数 ÷ 发起对话人数 |
| 评分率 | 评分用户数 ÷ 生成洞察用户数 |
| 点踩率 | 点踩轮次数 ÷ 总对话轮次数 |

---

## 页面布局

```
┌─────────────────────────────────────────────────────────────┐
│  齐家AI 数据看板                          更新于 HH:MM [刷新] │
│  数据每日更新 | 基于自然日 0:00-24:00 | 昨日数据：YYYY/MM/DD  │
├─────────────────────────────────────────────────────────────┤
│  一、基础数据                                                │
│  ├─ 1.1 核心指标卡片（昨日 + 累计）                          │
│  ├─ 1.2 转化率指标卡片                                      │
│  └─ 1.3 趋势图（可切换：人数/轮数/转化率）                    │
├─────────────────────────────────────────────────────────────┤
│  二、用户评分                                                │
│  ├─ 2.1 评分分布表格（5分、4分、低分、未评分）                │
│  └─ 2.2 趋势图（可切换：人数/占比）                          │
├─────────────────────────────────────────────────────────────┤
│  三、点踩数据                                                │
│  ├─ 3.1 核心指标卡片（点踩轮次数、点踩人数、点踩率）          │
│  └─ 3.2 趋势图（可切换：轮次数/人数/点踩率）                  │
├─────────────────────────────────────────────────────────────┤
│  四、AB版本对比                                              │
│  ├─ 时间选择器                                              │
│  └─ 对比表格（基础数据 + 评分 + 点踩）                       │
└─────────────────────────────────────────────────────────────┘
```

---

## 技术栈

- **前端**：React + Vite + Recharts
- **后端**：Node.js + Express
- **部署**：Railway（自动部署）

## 本地开发

```bash
# 安装依赖
npm install
npm install --prefix server
npm install --prefix client

# 启动开发服务器
npm run dev
```

## 部署

项目已配置 Railway 自动部署，推送到 main 分支即可触发部署。

---

## 权限说明

- **完全公开**：所有数据对外公开透明
